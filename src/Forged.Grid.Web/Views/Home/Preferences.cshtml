@model IQueryable<Person>

@{
    ViewBag.Title = "Grid user preferences";
}

<div class="widget example">
    <div class="widget-header">
        <div class="fa fa-bars"></div>
        <span>Preview</span>
        <div class="widget-buttons">
            <span id="GridConfigure" class="fa fa-cog"></span>
        </div>
    </div>
    <div class="widget-content">
        @(Html
            .Grid(Model)
            .Build(columns =>
            {
                columns.Add(model => model.Name).Hidden();
                columns.Add(model => model.Surname);
                columns.Add(model => model.MaritalStatus);

                columns.Add(model => model.Age);
                columns.Add(model => model.Birthday).Formatted("{0:d}");
                columns.Add(model => model.IsWorking);
            })
            .Empty("No data found")
            .Pageable(pager =>
            {
                pager.RowsPerPage = 4;
            })
            .Named("preferences")
            .Filterable()
            .Sortable()
        )
    </div>
</div>


@section scripts {
    <script>
        const configuration = localStorage.getItem("grid-config");
        const grid = new MvcGrid(document.querySelector(".forged-grid"));

        if (configuration) {
            grid.configure(JSON.parse(configuration));
        }

        document.getElementById("GridConfigure").addEventListener("click", function () {
            grid.showConfiguration(this);
        });

        document.addEventListener("gridconfigure", function (e) {
            localStorage.setItem("grid-config", JSON.stringify(e.detail.grid.getConfiguration()));
        });
    </script>
}
